<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/popper.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap3.7.css">
    <link rel="stylesheet" href="css/icon/iconfont.css">
    <link rel="stylesheet" href="css/order.css">
</head>

<body>
    <iframe src="./header.html" frameborder="0" scrolling="no" class="frame-div" onload="this.height=100"></iframe>

    <div class="container">
        <section>
            <div>
                <p></p>
                <p>半秋山西餐厅（鲁广店） ></p>
                <p> 确认购买</p>
            </div>
            <div>
                <div>
                    <ul>
                        <li>
                            <span>
                                订单详情
                            </span>
                            <span>
                                <a href="javascript:;">
                                    < 返回商家修改 
                                </a> 
                            </span> 
                        </li> 
                        <li>
                            <span>
                                菜品
                            </span>
                            <span>
                                份数/价格
                            </span>
                        </li>
                    </ul>
                    <div></div>
                </div>
                <div>
                    <h2>
                        收货地址
                        <a href="javascript:;">
                            添加新地址
                        </a>
                    </h2>
                    <div>
                        <div>
                            <p class="add-address">
                                <i>+</i>
                                <span>
                                    添加新地址
                                </span>
                            </p>
                            <div>
                                <h2>
                                    付款方式
                                    <span>
                                        推荐使用在线支付，不用找零，优惠更多
                                    </span>
                                </h2>
                                <div>
                                    <p>在线支付</p>
                                    <p>支持微信、支付宝、QQ钱包及大部分银行卡</p>
                                    <div>
                                        <i class="iconfont">&#xebe6;</i>
                                    </div>
                                </div>
                            </div>
                            <div class="another-info">
                                <h2>
                                    其他信息
                                </h2>
                                <div>
                                    <span>送达时间</span>
                                    <p>
                                        立即送达
                                        <i class="iconfont">&#xeb6d;</i>
                                    </p>
                                    <div>
                                        <ul>
                                            <li>立即送达</li>
                                            <li>16:30</li>
                                            <li>17:00</li>
                                            <li>17:30</li>
                                            <li>18:00</li>
                                            <li>18:30</li>
                                            <li>19:00</li>
                                        </ul>
                                    </div>
                                </div>
                                <div>
                                    <span>订单备注</span>
                                    <input type="text" name="order_descript" id="order_descript">
                                </div>
                                <div>
                                    <span>餐具份数</span>
                                    <i class="iconfont">&#xe601;</i>
                                    <p>
                                        未选择
                                        <i class="iconfont">&#xeb6d;</i>
                                    </p>
                                    <div>
                                        <ul>
                                            <li>
                                                <i class="iconfont">&#xe601;</i>
                                                无需餐具
                                            </li>
                                            <li>1份</li>
                                            <li>2份</li>
                                            <li>3份</li>
                                            <li>4份</li>
                                            <li>5份</li>
                                            <li>6份</li>
                                        </ul>
                                    </div>
                                </div>
                                <button>确认下单</button>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
    <iframe src="./footer.html" frameborder="0" scrolling="no" class="frame-div" onload="this.height=100"></iframe>

    <script src="js/frame.js"></script>
    <script src="js/ajax.js"></script>

    <script>
        $(function(){
            var urlParams = new URLSearchParams(location.search);
            var sid = urlParams.get('sid');
            var user = urlParams.get('user');
            ajax({
                url: '/user/getOrderInfo',
                type: 'post',
                data: `sid=${sid}&user=${user}`,
                dataType: 'json'
            }).then(function(data){
                console.log(data);
                $('section>div:first-child>p:nth-child(2)').html(`${data[0].shop_name} >`);
                var li_content = '';
                var total_price = 0;
                for (let i = 0; i < data.length; i++) {
                    const obj = data[i];
                    li_content += `
                    <li>
                        <span>
                            ${obj.name}
                        </span>
                        <span>
                            ￥${obj.un_price}*${obj.number}
                        </span>
                    </li>
                    `;
                    total_price += parseFloat(obj.un_price) * parseFloat(obj.number);
                }
                li_content += `
                    <li>
                    <span>包装费</span>
                    <span>￥2</span>
                    </li>
                    <li>
                        <span>配送费</span>
                        <span>￥${data[0].deliver_fee}</span>
                    </li>
                    <li>
                        <span>￥
                            <span>${total_price.toFixed(2)}</span>
                        </span>
                    </li>
                `;
                var ul = $('section>div:last-child>div:first-child>ul');
                ul.html(`${ul.html()}${li_content}`)
                // alert(ul.html())
            })
        })
        $('.another-info>div>p').mouseenter(function () {
            $(this).next().fadeIn();
        })
        $('.another-info>div>div').mouseleave(function(){
            $(this).fadeOut();
        })
    </script>
</body>

</html>