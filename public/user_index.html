<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/popper.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap3.7.css">
    <link rel="stylesheet" href="css/user-index.css">
    <link rel="stylesheet" href="css/icon/iconfont.css">
    <link href="css/jquery.city.css" rel="stylesheet" />
    <link href="css/animate.min.css" rel="stylesheet" />

    <script>
        $(function () {

            $.ajax({
                 type: "GET",
                 url: "/user/session",
                 dataType: "json",
                 success: function(data){
                             if(data.code == 200){
                                $('.login_user').html(`${data.msg.name}<i class="iconfont">&#xeb6d;</i>`)
                                $('.login_user').click(function(){
                                    return false;
                                })
                             }
                          }
             });

            $('#search').click(function () {
                $('.header-right').fadeOut();
                setTimeout(() => {
                    $('.test').fadeIn();
                }, 500)

            });
            $('.close').click(function () {
                $('.test').fadeOut();
                setTimeout(() => {
                    $('.header-right').fadeIn();
                }, 500)
            })

            var fixedDom = $('.header')[0];

            if ($('.hidden-sm').css('display') == 'none') {
                $('.show-btn').css('display', 'inline');
            } else {
                $('.show-btn').css('display', 'none')
            }
            $(window).resize(function () {
                if ($('.hidden-sm').css('display') == 'none') {
                    $('.show-btn').css('display', 'inline')
                } else {
                    $('#p2').removeClass('show');
                    $('.show-btn').css('display', 'none')
                }
            })

            $('#txt_city').jcity({
                urlOrData: 'js/citydata.json',
                animate: { showClass: 'animated flipInX', hideClass: 'animated flipOutX' },
                onChoice: function (data) {
                    console.log(data);
                }
            });
            $('.search-btn').click(function(){
                var xhr = new XMLHttpRequest();

                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        var result = xhr.responseText;
                        // var arr = JSON.parse(result); 
                        console.log(result);
                    }
                }
                var data = txt_city.value.replace(/\s*/ig, '');
                xhr.open('get', `/user/getlist?address=${data}`, true);

                
                xhr.send(null);
                return false;
            })
            
        })
    </script>
</head>

<body>
    <div class="container-fluid">
        <!-- <iframe src="./header.html" frameborder="0" scrolling="no" class="frame-div" onload="this.height=100"></iframe> -->
        <header class="header">
            <div class="nav container navbar-light">
                <div class="col-md-2 col-sm-3 col-xs-6">
                    <div class="logo"><a href="index.html"><img src="img/logo.png" alt=""></a></div>
                </div>

                <div class="col-md-10 col-sm-9 col-xs-6">
                    <div class="mgea-full-width">
                        <div class="header-right">
                            <div class="card">
                                <div class="card-header">
                                    <button type="button" class="btn show-btn navbar-toggler" data-toggle="collapse"
                                        data-target="#p2">
                                        <span class="navbar-toggler-icon"></span>
                                    </button>
                                </div>

                                <div id="p2" class="collapse" data-parent="#parent">
                                    <div class="card-body">
                                        <ul class="list-unstyled">
                                            <li>
                                                <a href="#"> 首页</a></li>
                                            <li>
                                                <a href="#"> 加盟</a></li>
                                            <li>
                                                <a href="#"> 点外卖</a></li>
                                            <li>
                                                <a href="#"> 关于我们</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="header-menu hidden-sm hidden-xs list-info">
                                <ul>
                                    <li><a href="#">首页</a></li>
                                    <li><a href="#">加盟</a></li>
                                    <li><a href="#">点外卖</a></li>
                                    <li><a href="#">公告</a></li>
                                    <li><a href="#">关于我们</a></li>
                                    <li id="search"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></li>
                                </ul>
                            </div>
                        </div>
                        <div class="test">
                            <div class="input-group inner-test">
                                <input type="search" class="form-control search-cotain" placeholder="Search for...">
                                <span class="input-group-btn">
                                    <button class="btn btn-default search-icon" type="button"><span class="glyphicon glyphicon-search"
                                            aria-hidden="true"></span></button>
                                    <button class="btn btn-default search-icon" type="button"><span class="glyphicon glyphicon-remove close"
                                            aria-hidden="true"></span></button>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <div class="main_img">
            <div class="address ">
                <div class="inner-address p-0">
                    <div class="row login_list">
                        <div class="col-lg-5 col-md-8 col-sm-10 d-flex p-0">
                            <div class="row detail-btn">
                                <div class="col-md-6 p-0 d-flex">
                                    <a href="login.html" class="btn mr-1 login_user">注册/登录</a>
                                </div>
                                <div class="col-md-6 p-0 pl-4">
                                    <a href="#" class="new-list-btn fr btn">
                                        我的订单
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="input-group mt-2 search-form row">
                        <input type="text" id="txt_city" class="form-control border-0 col-lg-8 col-md-7 col-sm-8" placeholder="输入地址搜索周边美食">
                        <a href="#" class="search-btn col-lg-2 col-md-3 col-sm-2">搜索</a>
                    </div>
                   
                </div>
            </div>
        </div>

        <iframe src="./footer.html" frameborder="0" scrolling="no" class="frame-div" onload="this.height=100"></iframe>


    </div>
    <script src="js/frame.js"></script>
    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/jquery.city.js"></script>

</body>

</html>